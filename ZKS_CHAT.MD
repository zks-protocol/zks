# ZKS Protocol: Post-Quantum Secure Anonymous Chat

> ‚ö†Ô∏è **IMPORTANT SECURITY CLARIFICATION**: This document previously made incorrect claims about "information-theoretic security" and "TRUE OTP". The ZKS Protocol provides **256-bit post-quantum computational security**, NOT information-theoretic security. True OTP requires physical key exchange - network-based systems cannot achieve Shannon secrecy.

## üîê 256-Bit Post-Quantum Computational Security

**ZKS Protocol provides 256-bit post-quantum computational security** using NIST-standardized algorithms (ML-KEM-1024, ML-DSA-87) combined with defense-in-depth entropy mixing.

---

## What Makes ZKS Secure?

### Security Model

| Aspect | ZKS Protocol |
|--------|--------------|
| **Security basis** | 256-bit computational (MLWE assumption) |
| **Quantum resistant** | ‚úÖ NIST Level 5 post-quantum |
| **Defense-in-depth** | ‚úÖ Multi-layer encryption |
| **Forward secrecy** | ‚úÖ Session rotation every 10 min |

### The Wasif-Vernam Cipher

A four-layer computational encryption scheme providing:

```
Layer 1: ChaCha20-Poly1305 (authenticated encryption)
Layer 2: High-entropy XOR (defense-in-depth)
Layer 3: Ciphertext scrambling (traffic analysis resistance)
Layer 4: Recursive key chains (forward secrecy)
```

**Entropy sources combined via XOR:**
- üåç **drand** ‚Äî Distributed randomness beacon (18+ operators)
- üíª **Local CSPRNG** ‚Äî System entropy

If **EITHER** source remains uncompromised, the encryption maintains **256-bit computational security**.

---

## How It Works

### Entropy Grid Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 Hierarchical Entropy System                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Level 1: Local cache (fastest)                                 ‚îÇ
‚îÇ  Level 2: Swarm peers (P2P distribution)                        ‚îÇ
‚îÇ  Level 3: IPFS storage (decentralized)                          ‚îÇ
‚îÇ  Level 4: Direct drand API (fallback)                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Per-Session Security

Each anonymous chat session:

1. **ML-KEM-1024 handshake** ‚Üí Post-quantum shared secret (NIST Level 5)
2. **Entropy mixing** ‚Üí drand ‚äï CSPRNG for defense-in-depth
3. **Session rotation** ‚Üí Automatic every 10 minutes

---

## Security Level

### Per Message
| Message Size | Security |
|--------------|----------|
| **ANY size** | üîê **256-bit post-quantum computational** |
| Fallback (entropy unavailable) | üîí ChaCha20-Poly1305 (256-bit) |

### Session Management
| Metric | Value |
|--------|-------|
| Key exchange | ML-KEM-1024 (NIST Level 5) |
| Signatures | ML-DSA-87 (post-quantum) |
| Session rotation | **Automatic** every 10 min |
| Forward secrecy | ‚úÖ Per-session key derivation |

---

## Why This Is Free

### No Token Required
Unlike some privacy networks that require tokens/fees:
- ‚úÖ drand is **free public infrastructure**
- ‚úÖ CURBy is **free academic service**
- ‚úÖ ZKS Protocol is **open source (AGPL-3.0)**

### Decentralized Verification
- drand: BLS threshold signatures from League of Entropy (Cloudflare, Protocol Labs, etc.)
- CURBy: Quantum Bell test verification from University of Colorado/NIST

---

## Comparison with Other Systems

| Feature | Signal | Telegram | ZKS Chat |
|---------|--------|----------|----------|
| E2E Encryption | ‚úÖ | ‚ö†Ô∏è Optional | ‚úÖ |
| Post-Quantum | ‚ùå | ‚ùå | ‚úÖ ML-KEM-1024 |
| Defense-in-depth | ‚ùå | ‚ùå | ‚úÖ 4-layer |
| Anonymous routing | ‚ùå | ‚ùå | ‚úÖ Faisal Swarm |
| Metadata protection | ‚ùå | ‚ùå | ‚úÖ |
| Forward secrecy | ‚úÖ | ‚ùå | ‚úÖ |

---

## Technical Implementation

### Entropy Sources

```rust
// Defense-in-depth: XOR combination ensures security if either source is uncompromised
mixed_entropy = drand_beacon(32) ‚äï local_CSPRNG(32)
```

### Wasif-Vernam Cipher

```rust
// Four-layer encryption
Layer 1: ChaCha20-Poly1305 authenticated encryption
Layer 2: High-entropy XOR with mixed entropy
Layer 3: Optional ciphertext scrambling
Layer 4: Recursive key chains for forward secrecy
```

### Large File Handling

```rust
// Hybrid Computational Encryption for files of any size
DEK = CSPRNG(32 bytes)
wrapped_DEK = DEK ‚äï mixed_entropy
ciphertext = ChaCha20_Poly1305(DEK, plaintext)
// 256-bit post-quantum computational security
```

---

## Security Properties

### Computational Security (256-bit)
- ‚úÖ **Post-quantum**: Resistant to Shor's algorithm attacks
- ‚úÖ **Defense-in-depth**: Multiple entropy sources via XOR
- ‚úÖ **Forward secrecy**: Session rotation with new key derivation

### üå™Ô∏è Entropy Swarm (P2P Randomness)
For large files (GBs), ZKS uses a **torrent-like swarm** to fetch historical drand rounds:
- **Distributed Load**: Peers share cached entropy rounds
- **Max Speed**: Parallel downloads from swarm peers
- **Trustless**: BLS signatures verify every drand round
- **Result**: Fast entropy distribution for high-throughput encryption

### Anonymity
- ‚úÖ **Faisal Swarm topology**: No single point of traffic analysis
- ‚úÖ **Cover traffic**: Constant bandwidth to prevent timing attacks
- ‚úÖ **SURB-based replies**: Sender remains anonymous even to recipient

---

## Use Cases

### Perfect for:
- üîí Whistleblower communications
- üè• Healthcare data (HIPAA)
- üíº Legal privilege communications
- üèõÔ∏è Government classified messaging
- üîê Financial transactions
- üë§ Human rights activists

### Why Post-Quantum Security Matters
> "256-bit computational security resistant to both classical and quantum attacks, built on NIST-standardized algorithms with defense-in-depth entropy mixing."

---

## Getting Started

```rust
use zks_sdk::prelude::*;

// Create post-quantum encrypted channel
let cipher = WasifVernam::new(shared_key)?;
cipher.derive_base_iv(&shared_key, true); // Required for encryption

// Encrypt message (256-bit post-quantum computational security)
let ciphertext = cipher.encrypt(b"Hello, secure world!")?;

// Decrypt
let plaintext = cipher.decrypt(&ciphertext)?;
```

---

## License

ZKS Protocol is open source under **AGPL-3.0**.

256-bit post-quantum security for everyone. üõ°Ô∏è

---

*Wasif-Vernam Cipher: Because privacy is a human right, not a premium feature.*
